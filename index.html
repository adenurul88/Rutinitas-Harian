<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rutinitas Harian</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
:root{
  --pink:#f7c6d9;
  --tosca:#9ad9d1;
  --pink-dark:#e9a9c1;
  --text:#444;
}

body{
  margin:0;
  color:var(--text);
  font-family:"Geraldine Jinn","Times New Roman",serif;
  background:#fff6f9;
  overflow-x:hidden;
}

/* ===== AURORA BACKGROUND ===== */
.aurora{
  position:fixed;
  inset:-50%;
  z-index:-1;
  background:
    radial-gradient(circle at 20% 30%, rgba(247,198,217,.45), transparent 40%),
    radial-gradient(circle at 80% 40%, rgba(154,217,209,.45), transparent 40%),
    radial-gradient(circle at 50% 80%, rgba(247,198,217,.35), transparent 40%);
  animation:auroraMove 18s ease-in-out infinite alternate;
}
@keyframes auroraMove{
  0%{transform:translate(0,0) rotate(0deg)}
  50%{transform:translate(-80px,60px) rotate(10deg)}
  100%{transform:translate(80px,-60px) rotate(-10deg)}
}

/* HEADER */
header{
  background:linear-gradient(135deg,var(--pink),var(--tosca));
  padding:18px;
  text-align:center;
  border-radius:0 0 20px 20px;
}
header h1{
  margin:0;
  font-family:"Amanda","Comic Sans MS",cursive;
  font-size:28px;
}
header p{font-size:14px;margin-top:4px}

/* CARD */
.section{
  background:#fff;
  margin:14px;
  padding:14px;
  border-radius:14px;
  box-shadow:0 4px 8px rgba(0,0,0,.05);
}

/* CHECK */
.check{
  display:flex;
  gap:8px;
  align-items:center;
  margin:8px 0;
}
.status-done{color:#2e8b57;font-weight:bold;}
.status-not{color:#777;}

/* NOTE */
.soft-note{
  font-size:12px;
  opacity:.6;
}

/* FOTO */
.photo{
  width:189px;
  height:189px;
  object-fit:cover;
  border-radius:8px;
  border:2px solid var(--pink);
  margin-top:6px;
}

/* BUTTON */
button{
  background:var(--tosca);
  border:none;
  padding:8px 14px;
  border-radius:20px;
  cursor:pointer;
  font-family:"Geraldine Jinn",serif;
}
button:hover{background:var(--pink-dark);}

/* FLOAT BUTTON */
.fab{
  position:fixed;
  bottom:20px;
  right:20px;
  width:56px;
  height:56px;
  border-radius:50%;
  font-size:26px;
  background:var(--pink);
  color:white;
  box-shadow:0 6px 12px rgba(0,0,0,.2);
}

/* ===== CONFETTI ===== */
.confetti{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:9999;
}
.confetti span{
  position:absolute;
  width:10px;
  height:16px;
  border-radius:3px;
  animation:fall 1.8s linear forwards;
}
@keyframes fall{
  0%{transform:translateY(-20px) rotate(0deg)}
  100%{transform:translateY(110vh) rotate(720deg);opacity:0}
}
</style>
</head>

<body>

<div class="aurora"></div>

<header>
  <h1>Rutinitas Harian</h1>
  <p id="today"></p>
</header>

<div class="section" style="text-align:center">
  <input type="date" id="calendar"
  style="padding:8px;border-radius:10px;border:1px solid #ddd"
  onchange="changeDate(this.value)">
</div>

<div id="routines"></div>

<div class="section">
  <button onclick="showHistory()">Riwayat Harian</button>
  <button onclick="exportPDF()">Export PDF</button>
  <div id="history"></div>
</div>

<button class="fab" onclick="addRoutine()">+</button>

<script>
const routines=[
  {n:"Mandi Pagi",t:"04:30"},
  {n:"Shalat Subuh",t:"04:55"},
  {n:"Dzikir Pagi",t:"05:05"},
  {n:"Sapu & Pel Rumah Pagi",t:"05:15"},
  {n:"Olahraga",t:"06:30"},
  {n:"Duolingo Matematika",t:"07:30"},
  {n:"Duolingo Bahasa Inggris",t:"08:00"},
  {n:"Pembersihan Cicilan",t:"09:00"},
  {n:"Shalat Dzuhur",t:"12:15"},
  {n:"Kajian",t:"12:45"},
  {n:"Baca Buku Target",t:"14:00"},
  {n:"Shalat Ashar",t:"15:35"},
  {n:"Dzikir Petang",t:"15:45"},
  {n:"Mandi Sore",t:"17:00"},
  {n:"Sapu & Pel Rumah Sore",t:"17:30"},
  {n:"Shalat Maghrib",t:"18:10"},
  {n:"Shalat Isya",t:"19:25"},
  {n:"Setoran Al-Qur'an",t:"21:00"},
  {n:"Tidur",t:"22:00"}
];

const today=new Date().toISOString().slice(0,10);
let selectedDate=today;

document.getElementById("today").innerText="Tanggal: "+today;
document.getElementById("calendar").value=today;

function load(){
  const data=JSON.parse(localStorage.getItem("data")||"{}");
  const c=document.getElementById("routines");
  c.innerHTML="";
  routines.forEach((r,i)=>{
    const key=selectedDate+"-"+i;
    const e=data[key]||{};
    const d=document.createElement("div");
    d.className="section";
    d.innerHTML=`
      <h3>${r.t} - ${r.n}</h3>
      <div class="check">
        <input type="checkbox" ${e.done?"checked":""}
        onchange="toggleDone('${key}',this.checked)">
        <span class="${e.done?"status-done":"status-not"}">
        ${e.done?"Sudah Dilakukan":"Belum Dilakukan"}
        </span>
      </div>
      <input type="file" accept="image/*"
      onchange="saveImage(event,'${key}')">
      ${e.img?`<img src="${e.img}" class="photo">`:``}
    `;
    c.appendChild(d);
  });
}

function toggleDone(k,v){
  const d=JSON.parse(localStorage.getItem("data")||"{}");
  if(!d[k])d[k]={};
  d[k].done=v;
  localStorage.setItem("data",JSON.stringify(d));
  if(v)confetti();
  load();
}

function saveImage(e,k){
  const r=new FileReader();
  r.onload=()=>{saveField(k,"img",r.result);load();}
  r.readAsDataURL(e.target.files[0]);
}
function saveField(k,f,v){
  const d=JSON.parse(localStorage.getItem("data")||"{}");
  if(!d[k])d[k]={};
  d[k][f]=v;
  localStorage.setItem("data",JSON.stringify(d));
}

function changeDate(d){
  selectedDate=d;
  document.getElementById("today").innerText="Tanggal: "+d;
  load();
}

function addRoutine(){
  const n=prompt("Nama rutinitas:");
  const t=prompt("Jam (HH:MM):");
  if(n&&t){routines.push({n,t});load();}
}

function showHistory(){
  const d=JSON.parse(localStorage.getItem("data")||"{}");
  const h=document.getElementById("history");
  h.innerHTML="<h3>Riwayat Harian</h3>";
  Object.keys(d).forEach(k=>{
    h.innerHTML+=`<p>${k} : ${d[k].done?"":""}</p>`;
  });
}

function exportPDF(){
  const {jsPDF}=window.jspdf;
  const pdf=new jsPDF();
  let y=10;
  pdf.text("Rutinitas "+selectedDate,10,y);
  y+=10;
  routines.forEach((r,i)=>{
    const e=JSON.parse(localStorage.getItem("data")||"{}")[selectedDate+"-"+i];
    pdf.text(`${r.t} - ${r.n} : ${e?.done?"Sudah":"Belum"}`,10,y);
    y+=8;
  });
  pdf.save("rutinitas-"+selectedDate+".pdf");
}

/* CONFETTI MERIAH */
function confetti(){
  const c=document.createElement("div");
  c.className="confetti";
  for(let i=0;i<80;i++){
    const s=document.createElement("span");
    s.style.left=Math.random()*100+"%";
    s.style.background=`hsl(${Math.random()*360},80%,70%)`;
    s.style.animationDuration=1+Math.random()*1.5+"s";
    c.appendChild(s);
  }
  document.body.appendChild(c);
  setTimeout(()=>c.remove(),2200);
}

load();
</script>
</body>
</html>