<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Monitoring Rutinitas Harian</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
:root{
  --pink:#f7c6d9;
  --tosca:#9ad9d1;
  --pink-dark:#e9a9c1;
  --gold:#ffd700;
  --text:#444;
}

body{
  margin:0;
  color:var(--text);
  font-family:"Geraldine Jinn","Times New Roman",serif;
  background:#fff6f9;
}

/* ===== AURORA ANIMATED ===== */
.aurora{
  position:fixed;
  inset:-40%;
  z-index:-1;
  background:
    radial-gradient(circle at 20% 30%, rgba(247,198,217,.55), transparent 45%),
    radial-gradient(circle at 80% 40%, rgba(154,217,209,.55), transparent 45%),
    radial-gradient(circle at 50% 80%, rgba(247,198,217,.45), transparent 45%);
  animation:auroraMove 20s ease-in-out infinite alternate;
}
@keyframes auroraMove{
  0%{transform:translate(0,0) rotate(0deg)}
  50%{transform:translate(-120px,80px) rotate(12deg)}
  100%{transform:translate(120px,-80px) rotate(-12deg)}
}

/* HEADER */
header{
  background:linear-gradient(135deg,var(--pink),var(--tosca));
  padding:18px;
  text-align:center;
  border-radius:0 0 22px 22px;
}
header h1{
  margin:0;
  font-family:"Amanda","Comic Sans MS",cursive;
}

/* CARD */
.section{
  background:#fff;
  margin:14px;
  padding:14px;
  border-radius:16px;
  box-shadow:0 6px 10px rgba(0,0,0,.05);
}

/* MONITORING */
.monitor{
  display:flex;
  justify-content:space-between;
  font-weight:bold;
  padding:10px;
  background:linear-gradient(135deg,#fff,var(--tosca));
  border-radius:12px;
}

/* CHECK */
.check{
  display:flex;
  gap:8px;
  align-items:center;
  margin:6px 0;
}
.status-done{color:#2e8b57;font-weight:bold;}
.status-not{color:#777;}

/* INPUT */
input[type="text"]{
  width:100%;
  padding:7px;
  border-radius:10px;
  border:1px solid #ddd;
  margin-top:6px;
}

/* FOTO */
.photo{
  width:189px;
  height:189px;
  object-fit:cover;
  border-radius:8px;
  border:2px solid var(--pink);
  margin-top:6px;
}

/* BUTTON */
button{
  background:var(--tosca);
  border:none;
  padding:8px 14px;
  border-radius:20px;
  cursor:pointer;
}
button:hover{background:var(--pink-dark);}

/* FAB */
.fab{
  position:fixed;
  bottom:20px;
  right:20px;
  width:56px;
  height:56px;
  border-radius:50%;
  font-size:26px;
  background:var(--pink);
  color:white;
  box-shadow:0 6px 12px rgba(0,0,0,.25);
}

/* ===== CONFETTI GOLD UP ===== */
.confetti{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:9999;
}
.confetti span{
  position:absolute;
  bottom:-20px;
  width:8px;
  height:14px;
  background:linear-gradient(#fff6b0,var(--gold));
  border-radius:3px;
  animation:goldUp 2s ease-out forwards;
}
@keyframes goldUp{
  0%{transform:translateY(0) rotate(0deg);opacity:1}
  100%{transform:translateY(-110vh) rotate(720deg);opacity:0}
}
</style>
</head>

<body>
<div class="aurora"></div>

<header>
  <h1>Monitoring Rutinitas Harian</h1>
  <p id="today"></p>
</header>

<div class="section monitor">
  <span>Progress Hari Ini</span>
  <span id="progress">0%</span>
</div>

<div class="section" style="text-align:center">
  <input type="date" id="calendar"
  style="padding:8px;border-radius:10px;border:1px solid #ddd"
  onchange="changeDate(this.value)">
</div>

<div id="routines"></div>

<button class="fab" onclick="addRoutine()">+</button>

<script>
const routines=[
  {n:"Mandi Pagi",t:"04:30"},
  {n:"Shalat Subuh",t:"04:55"},
  {n:"Dzikir Pagi",t:"05:05"},
  {n:"Sapu & Pel Rumah Pagi",t:"05:15"},
  {n:"Olahraga",t:"06:30"},
  {n:"Duolingo Matematika",t:"07:30"},
  {n:"Duolingo Bahasa Inggris",t:"08:00"},
  {n:"Pembersihan Cicilan",t:"09:00",extra:"Tempat"},
  {n:"Shalat Dzuhur",t:"12:15"},
  {n:"Kajian",t:"12:45",extra:"Judul"},
  {n:"Baca Buku Target",t:"14:00",extra:"Judul Buku & Bab"},
  {n:"Shalat Ashar",t:"15:35"},
  {n:"Dzikir Petang",t:"15:45"},
  {n:"Mandi Sore",t:"17:00"},
  {n:"Sapu & Pel Rumah Sore",t:"17:30"},
  {n:"Shalat Maghrib",t:"18:10"},
  {n:"Shalat Isya",t:"19:25"},
  {n:"Setoran Al-Qur'an",t:"21:00",extra:"Surah & Ayat"},
  {n:"Tidur",t:"22:00"}
];

const today=new Date().toISOString().slice(0,10);
let selectedDate=today;

document.getElementById("today").innerText="Tanggal: "+today;
document.getElementById("calendar").value=today;

function load(){
  const data=JSON.parse(localStorage.getItem("data")||"{}");
  const c=document.getElementById("routines");
  c.innerHTML="";
  let doneCount=0;

  routines.forEach((r,i)=>{
    const key=selectedDate+"-"+i;
    const e=data[key]||{};
    if(e.done)doneCount++;

    const d=document.createElement("div");
    d.className="section";
    d.innerHTML=`
      <h3>${r.t} - ${r.n}</h3>
      <div class="check">
        <input type="checkbox" ${e.done?"checked":""}
        onchange="toggleDone('${key}',this.checked)">
        <span class="${e.done?"status-done":"status-not"}">
        ${e.done?"Sudah Dilakukan":"Belum Dilakukan"}
        </span>
      </div>

      ${r.extra?`
      <input type="text" placeholder="${r.extra}"
      value="${e.extra||""}"
      oninput="saveField('${key}','extra',this.value)">
      `:""}

      <input type="file" accept="image/*"
      onchange="saveImage(event,'${key}')">
      ${e.img?`<img src="${e.img}" class="photo">`:``}
    `;
    c.appendChild(d);
  });

  document.getElementById("progress").innerText=
    Math.round((doneCount/routines.length)*100)+"%";
}

function toggleDone(k,v){
  const d=JSON.parse(localStorage.getItem("data")||"{}");
  if(!d[k])d[k]={};
  d[k].done=v;
  localStorage.setItem("data",JSON.stringify(d));
  if(v)confettiGold();
  load();
}

function saveImage(e,k){
  const r=new FileReader();
  r.onload=()=>{saveField(k,"img",r.result);load();}
  r.readAsDataURL(e.target.files[0]);
}
function saveField(k,f,v){
  const d=JSON.parse(localStorage.getItem("data")||"{}");
  if(!d[k])d[k]={};
  d[k][f]=v;
  localStorage.setItem("data",JSON.stringify(d));
}
function changeDate(d){
  selectedDate=d;
  document.getElementById("today").innerText="Tanggal: "+d;
  load();
}
function addRoutine(){
  const n=prompt("Nama rutinitas:");
  const t=prompt("Jam (HH:MM):");
  if(n&&t){routines.push({n,t});load();}
}

/* CONFETTI EMAS KE ATAS */
function confettiGold(){
  const c=document.createElement("div");
  c.className="confetti";
  for(let i=0;i<90;i++){
    const s=document.createElement("span");
    s.style.left=Math.random()*100+"%";
    s.style.animationDuration=1.5+Math.random()*1.5+"s";
    c.appendChild(s);
  }
  document.body.appendChild(c);
  setTimeout(()=>c.remove(),2500);
}

load();
</script>
</body>
</html>